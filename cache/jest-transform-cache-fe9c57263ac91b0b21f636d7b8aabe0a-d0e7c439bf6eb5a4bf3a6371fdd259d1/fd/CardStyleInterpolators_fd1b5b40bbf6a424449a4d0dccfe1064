c7d6b290558a5f08f12df359529bc6b4
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.forHorizontalIOS = forHorizontalIOS;
exports.forVerticalIOS = forVerticalIOS;
exports.forModalPresentationIOS = forModalPresentationIOS;
exports.forFadeFromBottomAndroid = forFadeFromBottomAndroid;
exports.forRevealFromBottomAndroid = forRevealFromBottomAndroid;
exports.forScaleFromCenterAndroid = forScaleFromCenterAndroid;
exports.forNoAnimation = forNoAnimation;

var _reactNative = require("react-native");

var _conditional = _interopRequireDefault(require("../utils/conditional"));

var add = _reactNative.Animated.add,
    multiply = _reactNative.Animated.multiply;

function forHorizontalIOS(_ref) {
  var current = _ref.current,
      next = _ref.next,
      inverted = _ref.inverted,
      screen = _ref.layouts.screen;
  var translateFocused = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.width, 0],
    extrapolate: 'clamp'
  }), inverted);
  var translateUnfocused = next ? multiply(next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, screen.width * -0.3],
    extrapolate: 'clamp'
  }), inverted) : 0;
  var overlayOpacity = current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 0.07],
    extrapolate: 'clamp'
  });
  var shadowOpacity = current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 0.3],
    extrapolate: 'clamp'
  });
  return {
    cardStyle: {
      transform: [{
        translateX: translateFocused
      }, {
        translateX: translateUnfocused
      }]
    },
    overlayStyle: {
      opacity: overlayOpacity
    },
    shadowStyle: {
      shadowOpacity: shadowOpacity
    }
  };
}

function forVerticalIOS(_ref2) {
  var current = _ref2.current,
      inverted = _ref2.inverted,
      screen = _ref2.layouts.screen;
  var translateY = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height, 0],
    extrapolate: 'clamp'
  }), inverted);
  return {
    cardStyle: {
      transform: [{
        translateY: translateY
      }]
    }
  };
}

function forModalPresentationIOS(_ref3) {
  var index = _ref3.index,
      current = _ref3.current,
      next = _ref3.next,
      inverted = _ref3.inverted,
      screen = _ref3.layouts.screen,
      insets = _ref3.insets;
  var isLandscape = screen.width > screen.height;
  var topOffset = isLandscape ? 0 : 10;
  var statusBarHeight = insets.top;
  var aspectRatio = screen.height / screen.width;
  var progress = add(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }), next ? next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }) : 0);
  var translateY = multiply(progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [screen.height, index === 0 ? 0 : topOffset, (index === 0 ? statusBarHeight : 0) - topOffset * aspectRatio]
  }), inverted);
  var overlayOpacity = progress.interpolate({
    inputRange: [0, 1, 1.0001, 2],
    outputRange: [0, 0.3, 1, 1]
  });
  var scale = isLandscape ? 1 : progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [1, 1, screen.width ? 1 - topOffset * 2 / screen.width : 1]
  });
  var borderRadius = isLandscape ? 0 : index === 0 ? progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [0, 0, 10]
  }) : 10;
  return {
    cardStyle: {
      overflow: 'hidden',
      borderTopLeftRadius: borderRadius,
      borderTopRightRadius: borderRadius,
      marginTop: index === 0 ? 0 : statusBarHeight,
      transform: [{
        translateY: translateY
      }, {
        scale: scale
      }]
    },
    overlayStyle: {
      opacity: overlayOpacity
    }
  };
}

function forFadeFromBottomAndroid(_ref4) {
  var current = _ref4.current,
      inverted = _ref4.inverted,
      screen = _ref4.layouts.screen,
      closing = _ref4.closing;
  var translateY = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height * 0.08, 0],
    extrapolate: 'clamp'
  }), inverted);
  var opacity = (0, _conditional.default)(closing, current.progress, current.progress.interpolate({
    inputRange: [0, 0.5, 0.9, 1],
    outputRange: [0, 0.25, 0.7, 1]
  }));
  return {
    cardStyle: {
      opacity: opacity,
      transform: [{
        translateY: translateY
      }]
    }
  };
}

function forRevealFromBottomAndroid(_ref5) {
  var current = _ref5.current,
      next = _ref5.next,
      inverted = _ref5.inverted,
      screen = _ref5.layouts.screen;
  var containerTranslateY = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height, 0],
    extrapolate: 'clamp'
  }), inverted);
  var cardTranslateYFocused = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height * (95.9 / 100) * -1, 0],
    extrapolate: 'clamp'
  }), inverted);
  var cardTranslateYUnfocused = next ? multiply(next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, screen.height * (2 / 100) * -1],
    extrapolate: 'clamp'
  }), inverted) : 0;
  var overlayOpacity = current.progress.interpolate({
    inputRange: [0, 0.36, 1],
    outputRange: [0, 0.1, 0.1],
    extrapolate: 'clamp'
  });
  return {
    containerStyle: {
      overflow: 'hidden',
      transform: [{
        translateY: containerTranslateY
      }]
    },
    cardStyle: {
      transform: [{
        translateY: cardTranslateYFocused
      }, {
        translateY: cardTranslateYUnfocused
      }]
    },
    overlayStyle: {
      opacity: overlayOpacity
    }
  };
}

function forScaleFromCenterAndroid(_ref6) {
  var current = _ref6.current,
      next = _ref6.next,
      closing = _ref6.closing;
  var progress = add(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }), next ? next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }) : 0);
  var opacity = progress.interpolate({
    inputRange: [0, 0.8, 1, 1.2, 2],
    outputRange: [0, 0.5, 1, 0.33, 0]
  });
  var scale = (0, _conditional.default)(closing, current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0.9, 1],
    extrapolate: 'clamp'
  }), progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [0.85, 1, 1.1]
  }));
  return {
    containerStyle: {
      opacity: opacity,
      transform: [{
        scale: scale
      }]
    }
  };
}

function forNoAnimation() {
  return {};
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNhcmRTdHlsZUludGVycG9sYXRvcnMudHN4Il0sIm5hbWVzIjpbImFkZCIsIm11bHRpcGx5IiwiQW5pbWF0ZWQiLCJjdXJyZW50IiwibmV4dCIsImludmVydGVkIiwibGF5b3V0cyIsInNjcmVlbiIsInRyYW5zbGF0ZUZvY3VzZWQiLCJpbnB1dFJhbmdlIiwib3V0cHV0UmFuZ2UiLCJleHRyYXBvbGF0ZSIsInRyYW5zbGF0ZVVuZm9jdXNlZCIsIm92ZXJsYXlPcGFjaXR5Iiwic2hhZG93T3BhY2l0eSIsImNhcmRTdHlsZSIsInRyYW5zZm9ybSIsInRyYW5zbGF0ZVgiLCJvdmVybGF5U3R5bGUiLCJvcGFjaXR5Iiwic2hhZG93U3R5bGUiLCJ0cmFuc2xhdGVZIiwiaW5kZXgiLCJpbnNldHMiLCJpc0xhbmRzY2FwZSIsInRvcE9mZnNldCIsInN0YXR1c0JhckhlaWdodCIsImFzcGVjdFJhdGlvIiwicHJvZ3Jlc3MiLCJzY2FsZSIsImJvcmRlclJhZGl1cyIsIm92ZXJmbG93IiwiYm9yZGVyVG9wTGVmdFJhZGl1cyIsImJvcmRlclRvcFJpZ2h0UmFkaXVzIiwibWFyZ2luVG9wIiwiY2xvc2luZyIsImNvbnRhaW5lclRyYW5zbGF0ZVkiLCJjYXJkVHJhbnNsYXRlWUZvY3VzZWQiLCJjYXJkVHJhbnNsYXRlWVVuZm9jdXNlZCIsImNvbnRhaW5lclN0eWxlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsSUFBQSxZQUFBLEdBQUEsT0FBQSxDQUFBLGNBQUEsQ0FBQTs7QUFDQSxJQUFBLFlBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxzQkFBQSxDQUFBLENBQUE7O0FBTVFBLElBQUFBLEcsR0FBa0JFLFlBQUFBLENBQUFBLFFBQUFBLENBQWxCRixHQUFBQTtBQUFBQSxJQUFLQyxRLEdBQWFDLFlBQUFBLENBQUFBLFFBQUFBLENBQWJELFFBQUxEOztBQUtELFNBQUEsZ0JBQUEsQ0FBQSxJQUFBLEVBS3FEO0FBSjFERyxNQUFBQSxPQUkwRCxHQUFB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QUdTLFFBQVEsQ0FBUkEsV0FBQUEsQ0FBcUI7QUFDbkNuQixJQUFBQSxVQUFVLEVBQUUsQ0FBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBRHVCLENBQ3ZCLENBRHVCO0FBRW5DQyxJQUFBQSxXQUFXLEVBQUUsQ0FBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLENBQUEsRUFBQSxJQUFBLEVBRmYsQ0FFZTtBQUZzQixHQUFyQmtCLENBQWhCO0FBS0EsTUFBTUMsS0FBSyxHQUFHLENBQUEsR0FBQSxZQUFBLENBQUEsT0FBQSxFQUFBLE9BQUEsRUFFWjFCLE9BQU8sQ0FBUEEsUUFBQUEsQ0FBQUEsV0FBQUEsQ0FBNkI7QUFDM0JNLElBQUFBLFVBQVUsRUFBRSxDQUFBLENBQUEsRUFEZSxDQUNmLENBRGU7QUFFM0JDLElBQUFBLFdBQVcsRUFBRSxDQUFBLEdBQUEsRUFGYyxDQUVkLENBRmM7QUFHM0JDLElBQUFBLFdBQVcsRUFMRDtBQUVpQixHQUE3QlIsQ0FGWSxFQU9aeUIsUUFBUSxDQUFSQSxXQUFBQSxDQUFxQjtBQUNuQm5CLElBQUFBLFVBQVUsRUFBRSxDQUFBLENBQUEsRUFBQSxDQUFBLEVBRE8sQ0FDUCxDQURPO0FBRW5CQyxJQUFBQSxXQUFXLEVBQUUsQ0FBQSxJQUFBLEVBQUEsQ0FBQSxFQVRqQixHQVNpQjtBQUZNLEdBQXJCa0IsQ0FQWSxDQUFkO0FBYUEsU0FBTztBQUNMVyxJQUFBQSxjQUFjLEVBQUU7QUFDZHBCLE1BQUFBLE9BQU8sRUFETyxPQUFBO0FBRWRILE1BQUFBLFNBQVMsRUFBRSxDQUFDO0FBQUVhLFFBQUFBLEtBQUssRUFIdkI7QUFHZ0IsT0FBRDtBQUZHO0FBRFgsR0FBUDtBQVFLOztBQUFBLFNBQUEsY0FBQSxHQUFzRDtBQUMzRCxTQUFBLEVBQUE7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFuaW1hdGVkIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBjb25kaXRpb25hbCBmcm9tICcuLi91dGlscy9jb25kaXRpb25hbCc7XG5pbXBvcnQge1xuICBTdGFja0NhcmRJbnRlcnBvbGF0aW9uUHJvcHMsXG4gIFN0YWNrQ2FyZEludGVycG9sYXRlZFN0eWxlLFxufSBmcm9tICcuLi90eXBlcyc7XG5cbmNvbnN0IHsgYWRkLCBtdWx0aXBseSB9ID0gQW5pbWF0ZWQ7XG5cbi8qKlxuICogU3RhbmRhcmQgaU9TLXN0eWxlIHNsaWRlIGluIGZyb20gdGhlIHJpZ2h0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ySG9yaXpvbnRhbElPUyh7XG4gIGN1cnJlbnQsXG4gIG5leHQsXG4gIGludmVydGVkLFxuICBsYXlvdXRzOiB7IHNjcmVlbiB9LFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCB0cmFuc2xhdGVGb2N1c2VkID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi53aWR0aCwgMF0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KSxcbiAgICBpbnZlcnRlZFxuICApO1xuXG4gIGNvbnN0IHRyYW5zbGF0ZVVuZm9jdXNlZCA9IG5leHRcbiAgICA/IG11bHRpcGx5KFxuICAgICAgICBuZXh0LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCBzY3JlZW4ud2lkdGggKiAtMC4zXSxcbiAgICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgICAgfSksXG4gICAgICAgIGludmVydGVkXG4gICAgICApXG4gICAgOiAwO1xuXG4gIGNvbnN0IG92ZXJsYXlPcGFjaXR5ID0gY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgIG91dHB1dFJhbmdlOiBbMCwgMC4wN10sXG4gICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gIH0pO1xuXG4gIGNvbnN0IHNoYWRvd09wYWNpdHkgPSBjdXJyZW50LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLjNdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgdHJhbnNmb3JtOiBbXG4gICAgICAgIC8vIFRyYW5zbGF0aW9uIGZvciB0aGUgYW5pbWF0aW9uIG9mIHRoZSBjdXJyZW50IGNhcmRcbiAgICAgICAgeyB0cmFuc2xhdGVYOiB0cmFuc2xhdGVGb2N1c2VkIH0sXG4gICAgICAgIC8vIFRyYW5zbGF0aW9uIGZvciB0aGUgYW5pbWF0aW9uIG9mIHRoZSBjYXJkIG9uIHRvcCBvZiB0aGlzXG4gICAgICAgIHsgdHJhbnNsYXRlWDogdHJhbnNsYXRlVW5mb2N1c2VkIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAgb3ZlcmxheVN0eWxlOiB7IG9wYWNpdHk6IG92ZXJsYXlPcGFjaXR5IH0sXG4gICAgc2hhZG93U3R5bGU6IHsgc2hhZG93T3BhY2l0eSB9LFxuICB9O1xufVxuXG4vKipcbiAqIFN0YW5kYXJkIGlPUy1zdHlsZSBzbGlkZSBpbiBmcm9tIHRoZSBib3R0b20gKHVzZWQgZm9yIG1vZGFscykuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JWZXJ0aWNhbElPUyh7XG4gIGN1cnJlbnQsXG4gIGludmVydGVkLFxuICBsYXlvdXRzOiB7IHNjcmVlbiB9LFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCB0cmFuc2xhdGVZID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi5oZWlnaHQsIDBdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgaW52ZXJ0ZWRcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgdHJhbnNmb3JtOiBbXG4gICAgICAgIC8vIFRyYW5zbGF0aW9uIGZvciB0aGUgYW5pbWF0aW9uIG9mIHRoZSBjdXJyZW50IGNhcmRcbiAgICAgICAgeyB0cmFuc2xhdGVZIH0sXG4gICAgICBdLFxuICAgIH0sXG4gIH07XG59XG5cbi8qKlxuICogU3RhbmRhcmQgaU9TLXN0eWxlIG1vZGFsIGFuaW1hdGlvbiBpbiBpT1MgMTMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JNb2RhbFByZXNlbnRhdGlvbklPUyh7XG4gIGluZGV4LFxuICBjdXJyZW50LFxuICBuZXh0LFxuICBpbnZlcnRlZCxcbiAgbGF5b3V0czogeyBzY3JlZW4gfSxcbiAgaW5zZXRzLFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCBpc0xhbmRzY2FwZSA9IHNjcmVlbi53aWR0aCA+IHNjcmVlbi5oZWlnaHQ7XG4gIGNvbnN0IHRvcE9mZnNldCA9IGlzTGFuZHNjYXBlID8gMCA6IDEwO1xuICBjb25zdCBzdGF0dXNCYXJIZWlnaHQgPSBpbnNldHMudG9wO1xuICBjb25zdCBhc3BlY3RSYXRpbyA9IHNjcmVlbi5oZWlnaHQgLyBzY3JlZW4ud2lkdGg7XG5cbiAgY29uc3QgcHJvZ3Jlc3MgPSBhZGQoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIDFdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgbmV4dFxuICAgICAgPyBuZXh0LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgICAgfSlcbiAgICAgIDogMFxuICApO1xuXG4gIGNvbnN0IHRyYW5zbGF0ZVkgPSBtdWx0aXBseShcbiAgICBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMSwgMl0sXG4gICAgICBvdXRwdXRSYW5nZTogW1xuICAgICAgICBzY3JlZW4uaGVpZ2h0LFxuICAgICAgICBpbmRleCA9PT0gMCA/IDAgOiB0b3BPZmZzZXQsXG4gICAgICAgIChpbmRleCA9PT0gMCA/IHN0YXR1c0JhckhlaWdodCA6IDApIC0gdG9wT2Zmc2V0ICogYXNwZWN0UmF0aW8sXG4gICAgICBdLFxuICAgIH0pLFxuICAgIGludmVydGVkXG4gICk7XG5cbiAgY29uc3Qgb3ZlcmxheU9wYWNpdHkgPSBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDEsIDEuMDAwMSwgMl0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLjMsIDEsIDFdLFxuICB9KTtcblxuICBjb25zdCBzY2FsZSA9IGlzTGFuZHNjYXBlXG4gICAgPyAxXG4gICAgOiBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFswLCAxLCAyXSxcbiAgICAgICAgb3V0cHV0UmFuZ2U6IFtcbiAgICAgICAgICAxLFxuICAgICAgICAgIDEsXG4gICAgICAgICAgc2NyZWVuLndpZHRoID8gMSAtICh0b3BPZmZzZXQgKiAyKSAvIHNjcmVlbi53aWR0aCA6IDEsXG4gICAgICAgIF0sXG4gICAgICB9KTtcblxuICBjb25zdCBib3JkZXJSYWRpdXMgPSBpc0xhbmRzY2FwZVxuICAgID8gMFxuICAgIDogaW5kZXggPT09IDBcbiAgICA/IHByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgaW5wdXRSYW5nZTogWzAsIDEsIDJdLFxuICAgICAgICBvdXRwdXRSYW5nZTogWzAsIDAsIDEwXSxcbiAgICAgIH0pXG4gICAgOiAxMDtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgICAgYm9yZGVyVG9wTGVmdFJhZGl1czogYm9yZGVyUmFkaXVzLFxuICAgICAgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IGJvcmRlclJhZGl1cyxcbiAgICAgIG1hcmdpblRvcDogaW5kZXggPT09IDAgPyAwIDogc3RhdHVzQmFySGVpZ2h0LFxuICAgICAgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVZIH0sIHsgc2NhbGUgfV0sXG4gICAgfSxcbiAgICBvdmVybGF5U3R5bGU6IHsgb3BhY2l0eTogb3ZlcmxheU9wYWNpdHkgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBTdGFuZGFyZCBBbmRyb2lkLXN0eWxlIGZhZGUgaW4gZnJvbSB0aGUgYm90dG9tIGZvciBBbmRyb2lkIE9yZW8uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JGYWRlRnJvbUJvdHRvbUFuZHJvaWQoe1xuICBjdXJyZW50LFxuICBpbnZlcnRlZCxcbiAgbGF5b3V0czogeyBzY3JlZW4gfSxcbiAgY2xvc2luZyxcbn06IFN0YWNrQ2FyZEludGVycG9sYXRpb25Qcm9wcyk6IFN0YWNrQ2FyZEludGVycG9sYXRlZFN0eWxlIHtcbiAgY29uc3QgdHJhbnNsYXRlWSA9IG11bHRpcGx5KFxuICAgIGN1cnJlbnQucHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFtzY3JlZW4uaGVpZ2h0ICogMC4wOCwgMF0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KSxcbiAgICBpbnZlcnRlZFxuICApO1xuXG4gIGNvbnN0IG9wYWNpdHkgPSBjb25kaXRpb25hbChcbiAgICBjbG9zaW5nLFxuICAgIGN1cnJlbnQucHJvZ3Jlc3MsXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMC41LCAwLjksIDFdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFswLCAwLjI1LCAwLjcsIDFdLFxuICAgIH0pXG4gICk7XG5cbiAgcmV0dXJuIHtcbiAgICBjYXJkU3R5bGU6IHtcbiAgICAgIG9wYWNpdHksXG4gICAgICB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVkgfV0sXG4gICAgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBTdGFuZGFyZCBBbmRyb2lkLXN0eWxlIHJldmVhbCBmcm9tIHRoZSBib3R0b20gZm9yIEFuZHJvaWQgUGllLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9yUmV2ZWFsRnJvbUJvdHRvbUFuZHJvaWQoe1xuICBjdXJyZW50LFxuICBuZXh0LFxuICBpbnZlcnRlZCxcbiAgbGF5b3V0czogeyBzY3JlZW4gfSxcbn06IFN0YWNrQ2FyZEludGVycG9sYXRpb25Qcm9wcyk6IFN0YWNrQ2FyZEludGVycG9sYXRlZFN0eWxlIHtcbiAgY29uc3QgY29udGFpbmVyVHJhbnNsYXRlWSA9IG11bHRpcGx5KFxuICAgIGN1cnJlbnQucHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFtzY3JlZW4uaGVpZ2h0LCAwXSxcbiAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgIH0pLFxuICAgIGludmVydGVkXG4gICk7XG5cbiAgY29uc3QgY2FyZFRyYW5zbGF0ZVlGb2N1c2VkID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi5oZWlnaHQgKiAoOTUuOSAvIDEwMCkgKiAtMSwgMF0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KSxcbiAgICBpbnZlcnRlZFxuICApO1xuXG4gIGNvbnN0IGNhcmRUcmFuc2xhdGVZVW5mb2N1c2VkID0gbmV4dFxuICAgID8gbXVsdGlwbHkoXG4gICAgICAgIG5leHQucHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWzAsIHNjcmVlbi5oZWlnaHQgKiAoMiAvIDEwMCkgKiAtMV0sXG4gICAgICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgICAgIH0pLFxuICAgICAgICBpbnZlcnRlZFxuICAgICAgKVxuICAgIDogMDtcblxuICBjb25zdCBvdmVybGF5T3BhY2l0eSA9IGN1cnJlbnQucHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgIGlucHV0UmFuZ2U6IFswLCAwLjM2LCAxXSxcbiAgICBvdXRwdXRSYW5nZTogWzAsIDAuMSwgMC4xXSxcbiAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBjb250YWluZXJTdHlsZToge1xuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgICAgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVZOiBjb250YWluZXJUcmFuc2xhdGVZIH1dLFxuICAgIH0sXG4gICAgY2FyZFN0eWxlOiB7XG4gICAgICB0cmFuc2Zvcm06IFtcbiAgICAgICAgeyB0cmFuc2xhdGVZOiBjYXJkVHJhbnNsYXRlWUZvY3VzZWQgfSxcbiAgICAgICAgeyB0cmFuc2xhdGVZOiBjYXJkVHJhbnNsYXRlWVVuZm9jdXNlZCB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIG92ZXJsYXlTdHlsZTogeyBvcGFjaXR5OiBvdmVybGF5T3BhY2l0eSB9LFxuICB9O1xufVxuXG4vKipcbiAqIFN0YW5kYXJkIEFuZHJvaWQtc3R5bGUgcmV2ZWFsIGZyb20gdGhlIGJvdHRvbSBmb3IgQW5kcm9pZCBRLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9yU2NhbGVGcm9tQ2VudGVyQW5kcm9pZCh7XG4gIGN1cnJlbnQsXG4gIG5leHQsXG4gIGNsb3NpbmcsXG59OiBTdGFja0NhcmRJbnRlcnBvbGF0aW9uUHJvcHMpOiBTdGFja0NhcmRJbnRlcnBvbGF0ZWRTdHlsZSB7XG4gIGNvbnN0IHByb2dyZXNzID0gYWRkKFxuICAgIGN1cnJlbnQucHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgIH0pLFxuICAgIG5leHRcbiAgICAgID8gbmV4dC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgICAgIG91dHB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgICAgIH0pXG4gICAgICA6IDBcbiAgKTtcblxuICBjb25zdCBvcGFjaXR5ID0gcHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgIGlucHV0UmFuZ2U6IFswLCAwLjgsIDEsIDEuMiwgMl0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLjUsIDEsIDAuMzMsIDBdLFxuICB9KTtcblxuICBjb25zdCBzY2FsZSA9IGNvbmRpdGlvbmFsKFxuICAgIGNsb3NpbmcsXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAuOSwgMV0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KSxcbiAgICBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMSwgMl0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAuODUsIDEsIDEuMV0sXG4gICAgfSlcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGNvbnRhaW5lclN0eWxlOiB7XG4gICAgICBvcGFjaXR5LFxuICAgICAgdHJhbnNmb3JtOiBbeyBzY2FsZSB9XSxcbiAgICB9LFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9yTm9BbmltYXRpb24oKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICByZXR1cm4ge307XG59XG4iXX0=