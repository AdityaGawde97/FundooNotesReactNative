ebf91acbc674024f124445a7f2cbee82
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _require = require('react-native'),
    NativeModules = _require.NativeModules;

var RCTAsyncStorage = NativeModules.PlatformLocalStorage || NativeModules.RNC_AsyncSQLiteDBStorage || NativeModules.RNCAsyncStorage;

if (!RCTAsyncStorage) {
  throw new Error("[@RNC/AsyncStorage]: NativeModule: AsyncStorage is null.\n\nTo fix this issue try these steps:\n\n  \u2022 Run `react-native link @react-native-community/async-storage` in the project root.\n\n  \u2022 Rebuild and restart the app.\n\n  \u2022 Run the packager with `--clearCache` flag.\n\n  \u2022 If you are using CocoaPods on iOS, run `pod install` in the `ios` directory and then rebuild and re-run the app.\n\n  \u2022 If this happens while testing with Jest, check out docs how to integrate AsyncStorage with it: https://github.com/react-native-community/async-storage/blob/LEGACY/docs/Jest-integration.md\n\nIf none of these fix the issue, please open an issue on the Github repository: https://github.com/react-native-community/react-native-async-storage/issues \n");
}

function checkValidInput(usedKey, value) {
  var isValuePassed = arguments.length > 1;

  if (typeof usedKey !== 'string') {
    console.warn("[AsyncStorage] Using " + typeof usedKey + " type for key is not supported. This can lead to unexpected behavior/errors. Use string instead.\nKey passed: " + usedKey + "\n");
  }

  if (isValuePassed && typeof value !== 'string') {
    if (value == null) {
      throw new Error("[AsyncStorage] Passing null/undefined as value is not supported. If you want to remove value, Use .remove method instead.\nPassed value: " + value + "\nPassed key: " + usedKey + "\n");
    } else {
      console.warn("[AsyncStorage] The value for key \"" + usedKey + "\" is not a string. This can lead to unexpected behavior/errors. Consider stringifying it.\nPassed value: " + value + "\nPassed key: " + usedKey + "\n");
    }
  }
}

var AsyncStorage = {
  _getRequests: [],
  _getKeys: [],
  _immediate: null,
  getItem: function getItem(key, callback) {
    return new Promise(function (resolve, reject) {
      checkValidInput(key);
      RCTAsyncStorage.multiGet([key], function (errors, result) {
        var value = result && result[0] && result[0][1] ? result[0][1] : null;
        var errs = convertErrors(errors);
        callback && callback(errs && errs[0], value);

        if (errs) {
          reject(errs[0]);
        } else {
          resolve(value);
        }
      });
    });
  },
  setItem: function setItem(key, value, callback) {
    return new Promise(function (resolve, reject) {
      checkValidInput(key, value);
      RCTAsyncStorage.multiSet([[key, value]], function (errors) {
        var errs = convertErrors(errors);
        callback && callback(errs && errs[0]);

        if (errs) {
          reject(errs[0]);
        } else {
          resolve(null);
        }
      });
    });
  },
  removeItem: function removeItem(key, callback) {
    return new Promise(function (resolve, reject) {
      checkValidInput(key);
      RCTAsyncStorage.multiRemove([key], function (errors) {
        var errs = convertErrors(errors);
        callback && callback(errs && errs[0]);

        if (errs) {
          reject(errs[0]);
        } else {
          resolve(null);
        }
      });
    });
  },
  mergeItem: function mergeItem(key, value, callback) {
    return new Promise(function (resolve, reject) {
      checkValidInput(key, value);
      RCTAsyncStorage.multiMerge([[key, value]], function (errors) {
        var errs = convertErrors(errors);
        callback && callback(errs && errs[0]);

        if (errs) {
          reject(errs[0]);
        } else {
          resolve(null);
        }
      });
    });
  },
  clear: function clear(callback) {
    return new Promise(function (resolve, reject) {
      RCTAsyncStorage.clear(function (error) {
        var err = convertError(error);
        callback && callback(err);

        if (err) {
          reject(err);
        } else {
          resolve(null);
        }
      });
    });
  },
  getAllKeys: function getAllKeys(callback) {
    return new Promise(function (resolve, reject) {
      RCTAsyncStorage.getAllKeys(function (error, keys) {
        var err = convertError(error);
        callback && callback(err, keys);

        if (err) {
          reject(err);
        } else {
          resolve(keys);
        }
      });
    });
  },
  flushGetRequests: function flushGetRequests() {
    var getRequests = this._getRequests;
    var getKeys = this._getKeys;
    this._getRequests = [];
    this._getKeys = [];
    RCTAsyncStorage.multiGet(getKeys, function (errors, result) {
      var map = {};
      result && result.forEach(function (_ref) {
        var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
            key = _ref2[0],
            value = _ref2[1];

        map[key] = value;
        return value;
      });
      var reqLength = getRequests.length;

      for (var i = 0; i < reqLength; i++) {
        var request = getRequests[i];
        var requestKeys = request.keys;
        var requestResult = requestKeys.map(function (key) {
          return [key, map[key]];
        });
        request.callback && request.callback(null, requestResult);
        request.resolve && request.resolve(requestResult);
      }
    });
  },
  multiGet: function multiGet(keys, callback) {
    var _this = this;

    if (!this._immediate) {
      this._immediate = setImmediate(function () {
        _this._immediate = null;

        _this.flushGetRequests();
      });
    }

    var getRequest = {
      keys: keys,
      callback: callback,
      keyIndex: this._getKeys.length,
      resolve: null,
      reject: null
    };
    var promiseResult = new Promise(function (resolve, reject) {
      getRequest.resolve = resolve;
      getRequest.reject = reject;
    });

    this._getRequests.push(getRequest);

    keys.forEach(function (key) {
      if (_this._getKeys.indexOf(key) === -1) {
        _this._getKeys.push(key);
      }
    });
    return promiseResult;
  },
  multiSet: function multiSet(keyValuePairs, callback) {
    return new Promise(function (resolve, reject) {
      keyValuePairs.forEach(function (_ref3) {
        var _ref4 = (0, _slicedToArray2.default)(_ref3, 2),
            key = _ref4[0],
            value = _ref4[1];

        checkValidInput(key, value);
      });
      RCTAsyncStorage.multiSet(keyValuePairs, function (errors) {
        var error = convertErrors(errors);
        callback && callback(error);

        if (error) {
          reject(error);
        } else {
          resolve(null);
        }
      });
    });
  },
  multiRemove: function multiRemove(keys, callback) {
    return new Promise(function (resolve, reject) {
      keys.forEach(function (key) {
        return checkValidInput(key);
      });
      RCTAsyncStorage.multiRemove(keys, function (errors) {
        var error = convertErrors(errors);
        callback && callback(error);

        if (error) {
          reject(error);
        } else {
          resolve(null);
        }
      });
    });
  },
  multiMerge: function multiMerge(keyValuePairs, callback) {
    return new Promise(function (resolve, reject) {
      RCTAsyncStorage.multiMerge(keyValuePairs, function (errors) {
        var error = convertErrors(errors);
        callback && callback(error);

        if (error) {
          reject(error);
        } else {
          resolve(null);
        }
      });
    });
  }
};

if (!RCTAsyncStorage.multiMerge) {
  delete AsyncStorage.mergeItem;
  delete AsyncStorage.multiMerge;
}

function convertErrors(errs) {
  if (!errs) {
    return null;
  }

  return (Array.isArray(errs) ? errs : [errs]).map(function (e) {
    return convertError(e);
  });
}

function convertError(error) {
  if (!error) {
    return null;
  }

  var out = new Error(error.message);
  out.key = error.key;
  return out;
}

var _default = AsyncStorage;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFzeW5jU3RvcmFnZS5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiTmF0aXZlTW9kdWxlcyIsIlJDVEFzeW5jU3RvcmFnZSIsIlBsYXRmb3JtTG9jYWxTdG9yYWdlIiwiUk5DX0FzeW5jU1FMaXRlREJTdG9yYWdlIiwiUk5DQXN5bmNTdG9yYWdlIiwiRXJyb3IiLCJjaGVja1ZhbGlkSW5wdXQiLCJ1c2VkS2V5IiwidmFsdWUiLCJpc1ZhbHVlUGFzc2VkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiY29uc29sZSIsIndhcm4iLCJBc3luY1N0b3JhZ2UiLCJfZ2V0UmVxdWVzdHMiLCJfZ2V0S2V5cyIsIl9pbW1lZGlhdGUiLCJnZXRJdGVtIiwia2V5IiwiY2FsbGJhY2siLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm11bHRpR2V0IiwiZXJyb3JzIiwicmVzdWx0IiwiZXJycyIsImNvbnZlcnRFcnJvcnMiLCJzZXRJdGVtIiwibXVsdGlTZXQiLCJyZW1vdmVJdGVtIiwibXVsdGlSZW1vdmUiLCJtZXJnZUl0ZW0iLCJtdWx0aU1lcmdlIiwiY2xlYXIiLCJlcnJvciIsImVyciIsImNvbnZlcnRFcnJvciIsImdldEFsbEtleXMiLCJrZXlzIiwiZmx1c2hHZXRSZXF1ZXN0cyIsImdldFJlcXVlc3RzIiwiZ2V0S2V5cyIsIm1hcCIsImZvckVhY2giLCJyZXFMZW5ndGgiLCJpIiwicmVxdWVzdCIsInJlcXVlc3RLZXlzIiwicmVxdWVzdFJlc3VsdCIsInNldEltbWVkaWF0ZSIsImdldFJlcXVlc3QiLCJrZXlJbmRleCIsInByb21pc2VSZXN1bHQiLCJwdXNoIiwiaW5kZXhPZiIsImtleVZhbHVlUGFpcnMiLCJBcnJheSIsImlzQXJyYXkiLCJlIiwib3V0IiwibWVzc2FnZSJdLCJtYXBwaW5ncyI6IkFBV0E7Ozs7Ozs7Ozs7O2VBRXdCQSxPQUFPLENBQUMsY0FBRCxDO0lBQXhCQyxhLFlBQUFBLGE7O0FBRVAsSUFBTUMsZUFBZSxHQUNuQkQsYUFBYSxDQUFDRSxv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O0FBQ0QsU0FBTyxDQUFDK0IsS0FBSyxDQUFDQyxPQUFOLENBQWNoQyxJQUFkLElBQXNCQSxJQUF0QixHQUE2QixDQUFDQSxJQUFELENBQTlCLEVBQXNDaUIsR0FBdEMsQ0FBMEMsVUFBQWdCLENBQUM7QUFBQSxXQUFJdEIsWUFBWSxDQUFDc0IsQ0FBRCxDQUFoQjtBQUFBLEdBQTNDLENBQVA7QUFDRDs7QUFFRCxTQUFTdEIsWUFBVCxDQUFzQkYsS0FBdEIsRUFBcUM7QUFDbkMsTUFBSSxDQUFDQSxLQUFMLEVBQVk7QUFDVixXQUFPLElBQVA7QUFDRDs7QUFDRCxNQUFNeUIsR0FBRyxHQUFHLElBQUl4RCxLQUFKLENBQVUrQixLQUFLLENBQUMwQixPQUFoQixDQUFaO0FBRUFELEVBQUFBLEdBQUcsQ0FBQzFDLEdBQUosR0FBVWlCLEtBQUssQ0FBQ2pCLEdBQWhCO0FBQ0EsU0FBTzBDLEdBQVA7QUFDRDs7ZUFFYy9DLFkiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKiBAanNkb2NcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IHtOYXRpdmVNb2R1bGVzfSA9IHJlcXVpcmUoJ3JlYWN0LW5hdGl2ZScpO1xuXG5jb25zdCBSQ1RBc3luY1N0b3JhZ2UgPVxuICBOYXRpdmVNb2R1bGVzLlBsYXRmb3JtTG9jYWxTdG9yYWdlIHx8IC8vIFN1cHBvcnQgZm9yIGV4dGVybmFsIG1vZHVsZXMsIGxpa2UgcmVhY3QtbmF0aXZlLXdpbmRvd3NcbiAgTmF0aXZlTW9kdWxlcy5STkNfQXN5bmNTUUxpdGVEQlN0b3JhZ2UgfHxcbiAgTmF0aXZlTW9kdWxlcy5STkNBc3luY1N0b3JhZ2U7XG5cbmlmICghUkNUQXN5bmNTdG9yYWdlKSB7XG4gIHRocm93IG5ldyBFcnJvcihgW0BSTkMvQXN5bmNTdG9yYWdlXTogTmF0aXZlTW9kdWxlOiBBc3luY1N0b3JhZ2UgaXMgbnVsbC5cblxuVG8gZml4IHRoaXMgaXNzdWUgdHJ5IHRoZXNlIHN0ZXBzOlxuXG4gIOKAoiBSdW4gXFxgcmVhY3QtbmF0aXZlIGxpbmsgQHJlYWN0LW5hdGl2ZS1jb21tdW5pdHkvYXN5bmMtc3RvcmFnZVxcYCBpbiB0aGUgcHJvamVjdCByb290LlxuXG4gIOKAoiBSZWJ1aWxkIGFuZCByZXN0YXJ0IHRoZSBhcHAuXG5cbiAg4oCiIFJ1biB0aGUgcGFja2FnZXIgd2l0aCBcXGAtLWNsZWFyQ2FjaGVcXGAgZmxhZy5cblxuICDigKIgSWYgeW91IGFyZSB1c2luZyBDb2NvYVBvZHMgb24gaU9TLCBydW4gXFxgcG9kIGluc3RhbGxcXGAgaW4gdGhlIFxcYGlvc1xcYCBkaXJlY3RvcnkgYW5kIHRoZW4gcmVidWlsZCBhbmQgcmUtcnVuIHRoZSBhcHAuXG5cbiAg4oCiIElmIHRoaXMgaGFwcGVucyB3aGlsZSB0ZXN0aW5nIHdpdGggSmVzdCwgY2hlY2sgb3V0IGRvY3MgaG93IHRvIGludGVncmF0ZSBBc3luY1N0b3JhZ2Ugd2l0aCBpdDogaHR0cHM6Ly9naXRodWIuY29tL3JlYWN0LW5hdGl2ZS1jb21tdW5pdHkvYXN5bmMtc3RvcmFnZS9ibG9iL0xFR0FDWS9kb2NzL0plc3QtaW50ZWdyYXRpb24ubWRcblxuSWYgbm9uZSBvZiB0aGVzZSBmaXggdGhlIGlzc3VlLCBwbGVhc2Ugb3BlbiBhbiBpc3N1ZSBvbiB0aGUgR2l0aHViIHJlcG9zaXRvcnk6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWFjdC1uYXRpdmUtY29tbXVuaXR5L3JlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2lzc3VlcyBcbmApO1xufVxuXG50eXBlIFJlYWRPbmx5QXJyYXlTdHJpbmcgPSAkUmVhZE9ubHlBcnJheTxzdHJpbmc+O1xuXG50eXBlIE11bHRpR2V0Q2FsbGJhY2tGdW5jdGlvbiA9IChcbiAgZXJyb3JzOiA/JFJlYWRPbmx5QXJyYXk8RXJyb3I+LFxuICByZXN1bHQ6ID8kUmVhZE9ubHlBcnJheTxSZWFkT25seUFycmF5U3RyaW5nPixcbikgPT4gdm9pZDtcblxudHlwZSBNdWx0aVJlcXVlc3QgPSB7fFxuICBrZXlzOiAkUmVhZE9ubHlBcnJheTxzdHJpbmc+LFxuICBjYWxsYmFjazogP011bHRpR2V0Q2FsbGJhY2tGdW5jdGlvbixcbiAga2V5SW5kZXg6IG51bWJlcixcbiAgcmVzb2x2ZTogPyhyZXN1bHQ/OiBQcm9taXNlPD8kUmVhZE9ubHlBcnJheTxSZWFkT25seUFycmF5U3RyaW5nPj4pID0+IHZvaWQsXG4gIHJlamVjdDogPyhlcnJvcj86IGFueSkgPT4gdm9pZCxcbnx9O1xuXG5mdW5jdGlvbiBjaGVja1ZhbGlkSW5wdXQodXNlZEtleTogc3RyaW5nLCB2YWx1ZTogYW55KSB7XG4gIGNvbnN0IGlzVmFsdWVQYXNzZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMTtcblxuICBpZiAodHlwZW9mIHVzZWRLZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgYFtBc3luY1N0b3JhZ2VdIFVzaW5nICR7dHlwZW9mIHVzZWRLZXl9IHR5cGUgZm9yIGtleSBpcyBub3Qgc3VwcG9ydGVkLiBUaGlzIGNhbiBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3IvZXJyb3JzLiBVc2Ugc3RyaW5nIGluc3RlYWQuXFxuS2V5IHBhc3NlZDogJHt1c2VkS2V5fVxcbmAsXG4gICAgKTtcbiAgfVxuXG4gIGlmIChpc1ZhbHVlUGFzc2VkICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgW0FzeW5jU3RvcmFnZV0gUGFzc2luZyBudWxsL3VuZGVmaW5lZCBhcyB2YWx1ZSBpcyBub3Qgc3VwcG9ydGVkLiBJZiB5b3Ugd2FudCB0byByZW1vdmUgdmFsdWUsIFVzZSAucmVtb3ZlIG1ldGhvZCBpbnN0ZWFkLlxcblBhc3NlZCB2YWx1ZTogJHt2YWx1ZX1cXG5QYXNzZWQga2V5OiAke3VzZWRLZXl9XFxuYCxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgYFtBc3luY1N0b3JhZ2VdIFRoZSB2YWx1ZSBmb3Iga2V5IFwiJHt1c2VkS2V5fVwiIGlzIG5vdCBhIHN0cmluZy4gVGhpcyBjYW4gbGVhZCB0byB1bmV4cGVjdGVkIGJlaGF2aW9yL2Vycm9ycy4gQ29uc2lkZXIgc3RyaW5naWZ5aW5nIGl0LlxcblBhc3NlZCB2YWx1ZTogJHt2YWx1ZX1cXG5QYXNzZWQga2V5OiAke3VzZWRLZXl9XFxuYCxcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogYEFzeW5jU3RvcmFnZWAgaXMgYSBzaW1wbGUsIHVuZW5jcnlwdGVkLCBhc3luY2hyb25vdXMsIHBlcnNpc3RlbnQsIGtleS12YWx1ZVxuICogc3RvcmFnZSBzeXN0ZW0gdGhhdCBpcyBnbG9iYWwgdG8gdGhlIGFwcC4gIEl0IHNob3VsZCBiZSB1c2VkIGluc3RlYWQgb2ZcbiAqIExvY2FsU3RvcmFnZS5cbiAqXG4gKiBTZWUgaHR0cDovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9hc3luY3N0b3JhZ2UuaHRtbFxuICovXG5jb25zdCBBc3luY1N0b3JhZ2UgPSB7XG4gIF9nZXRSZXF1ZXN0czogKFtdOiBBcnJheTxNdWx0aVJlcXVlc3Q+KSxcbiAgX2dldEtleXM6IChbXTogQXJyYXk8c3RyaW5nPiksXG4gIF9pbW1lZGlhdGU6IChudWxsOiA/bnVtYmVyKSxcblxuICAvKipcbiAgICogRmV0Y2hlcyBhbiBpdGVtIGZvciBhIGBrZXlgIGFuZCBpbnZva2VzIGEgY2FsbGJhY2sgdXBvbiBjb21wbGV0aW9uLlxuICAgKlxuICAgKiBTZWUgaHR0cDovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9hc3luY3N0b3JhZ2UuaHRtbCNnZXRpdGVtXG4gICAqL1xuICBnZXRJdGVtOiBmdW5jdGlvbihcbiAgICBrZXk6IHN0cmluZyxcbiAgICBjYWxsYmFjaz86ID8oZXJyb3I6ID9FcnJvciwgcmVzdWx0OiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkLFxuICApOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY2hlY2tWYWxpZElucHV0KGtleSk7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlHZXQoW2tleV0sIGZ1bmN0aW9uKGVycm9ycywgcmVzdWx0KSB7XG4gICAgICAgIC8vIFVucGFjayByZXN1bHQgdG8gZ2V0IHZhbHVlIGZyb20gW1trZXksdmFsdWVdXVxuICAgICAgICBjb25zdCB2YWx1ZSA9IHJlc3VsdCAmJiByZXN1bHRbMF0gJiYgcmVzdWx0WzBdWzFdID8gcmVzdWx0WzBdWzFdIDogbnVsbDtcbiAgICAgICAgY29uc3QgZXJycyA9IGNvbnZlcnRFcnJvcnMoZXJyb3JzKTtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZXJycyAmJiBlcnJzWzBdLCB2YWx1ZSk7XG4gICAgICAgIGlmIChlcnJzKSB7XG4gICAgICAgICAgcmVqZWN0KGVycnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogU2V0cyB0aGUgdmFsdWUgZm9yIGEgYGtleWAgYW5kIGludm9rZXMgYSBjYWxsYmFjayB1cG9uIGNvbXBsZXRpb24uXG4gICAqXG4gICAqIFNlZSBodHRwOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL2FzeW5jc3RvcmFnZS5odG1sI3NldGl0ZW1cbiAgICovXG4gIHNldEl0ZW06IGZ1bmN0aW9uKFxuICAgIGtleTogc3RyaW5nLFxuICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgY2FsbGJhY2s/OiA/KGVycm9yOiA/RXJyb3IpID0+IHZvaWQsXG4gICk6IFByb21pc2U8bnVsbD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjaGVja1ZhbGlkSW5wdXQoa2V5LCB2YWx1ZSk7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlTZXQoW1trZXksIHZhbHVlXV0sIGZ1bmN0aW9uKGVycm9ycykge1xuICAgICAgICBjb25zdCBlcnJzID0gY29udmVydEVycm9ycyhlcnJvcnMpO1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlcnJzICYmIGVycnNbMF0pO1xuICAgICAgICBpZiAoZXJycykge1xuICAgICAgICAgIHJlamVjdChlcnJzWzBdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKG51bGwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogUmVtb3ZlcyBhbiBpdGVtIGZvciBhIGBrZXlgIGFuZCBpbnZva2VzIGEgY2FsbGJhY2sgdXBvbiBjb21wbGV0aW9uLlxuICAgKlxuICAgKiBTZWUgaHR0cDovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9hc3luY3N0b3JhZ2UuaHRtbCNyZW1vdmVpdGVtXG4gICAqL1xuICByZW1vdmVJdGVtOiBmdW5jdGlvbihcbiAgICBrZXk6IHN0cmluZyxcbiAgICBjYWxsYmFjaz86ID8oZXJyb3I6ID9FcnJvcikgPT4gdm9pZCxcbiAgKTogUHJvbWlzZTxudWxsPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNoZWNrVmFsaWRJbnB1dChrZXkpO1xuICAgICAgUkNUQXN5bmNTdG9yYWdlLm11bHRpUmVtb3ZlKFtrZXldLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgY29uc3QgZXJycyA9IGNvbnZlcnRFcnJvcnMoZXJyb3JzKTtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZXJycyAmJiBlcnJzWzBdKTtcbiAgICAgICAgaWYgKGVycnMpIHtcbiAgICAgICAgICByZWplY3QoZXJyc1swXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIE1lcmdlcyBhbiBleGlzdGluZyBga2V5YCB2YWx1ZSB3aXRoIGFuIGlucHV0IHZhbHVlLCBhc3N1bWluZyBib3RoIHZhbHVlc1xuICAgKiBhcmUgc3RyaW5naWZpZWQgSlNPTi5cbiAgICpcbiAgICogKipOT1RFOioqIFRoaXMgaXMgbm90IHN1cHBvcnRlZCBieSBhbGwgbmF0aXZlIGltcGxlbWVudGF0aW9ucy5cbiAgICpcbiAgICogU2VlIGh0dHA6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvYXN5bmNzdG9yYWdlLmh0bWwjbWVyZ2VpdGVtXG4gICAqL1xuICBtZXJnZUl0ZW06IGZ1bmN0aW9uKFxuICAgIGtleTogc3RyaW5nLFxuICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgY2FsbGJhY2s/OiA/KGVycm9yOiA/RXJyb3IpID0+IHZvaWQsXG4gICk6IFByb21pc2U8bnVsbD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjaGVja1ZhbGlkSW5wdXQoa2V5LCB2YWx1ZSk7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlNZXJnZShbW2tleSwgdmFsdWVdXSwgZnVuY3Rpb24oZXJyb3JzKSB7XG4gICAgICAgIGNvbnN0IGVycnMgPSBjb252ZXJ0RXJyb3JzKGVycm9ycyk7XG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycnMgJiYgZXJyc1swXSk7XG4gICAgICAgIGlmIChlcnJzKSB7XG4gICAgICAgICAgcmVqZWN0KGVycnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBFcmFzZXMgKmFsbCogYEFzeW5jU3RvcmFnZWAgZm9yIGFsbCBjbGllbnRzLCBsaWJyYXJpZXMsIGV0Yy4gWW91IHByb2JhYmx5XG4gICAqIGRvbid0IHdhbnQgdG8gY2FsbCB0aGlzOyB1c2UgYHJlbW92ZUl0ZW1gIG9yIGBtdWx0aVJlbW92ZWAgdG8gY2xlYXIgb25seVxuICAgKiB5b3VyIGFwcCdzIGtleXMuXG4gICAqXG4gICAqIFNlZSBodHRwOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL2FzeW5jc3RvcmFnZS5odG1sI2NsZWFyXG4gICAqL1xuICBjbGVhcjogZnVuY3Rpb24oY2FsbGJhY2s/OiA/KGVycm9yOiA/RXJyb3IpID0+IHZvaWQpOiBQcm9taXNlPG51bGw+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgUkNUQXN5bmNTdG9yYWdlLmNsZWFyKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgIGNvbnN0IGVyciA9IGNvbnZlcnRFcnJvcihlcnJvcik7XG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycik7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKG51bGwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyAqYWxsKiBrZXlzIGtub3duIHRvIHlvdXIgYXBwOyBmb3IgYWxsIGNhbGxlcnMsIGxpYnJhcmllcywgZXRjLlxuICAgKlxuICAgKiBTZWUgaHR0cDovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9hc3luY3N0b3JhZ2UuaHRtbCNnZXRhbGxrZXlzXG4gICAqL1xuICBnZXRBbGxLZXlzOiBmdW5jdGlvbihcbiAgICBjYWxsYmFjaz86ID8oZXJyb3I6ID9FcnJvciwga2V5czogP1JlYWRPbmx5QXJyYXlTdHJpbmcpID0+IHZvaWQsXG4gICk6IFByb21pc2U8UmVhZE9ubHlBcnJheVN0cmluZz4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UuZ2V0QWxsS2V5cyhmdW5jdGlvbihlcnJvciwga2V5cykge1xuICAgICAgICBjb25zdCBlcnIgPSBjb252ZXJ0RXJyb3IoZXJyb3IpO1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlcnIsIGtleXMpO1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShrZXlzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBmb2xsb3dpbmcgYmF0Y2hlZCBmdW5jdGlvbnMgYXJlIHVzZWZ1bCBmb3IgZXhlY3V0aW5nIGEgbG90IG9mXG4gICAqIG9wZXJhdGlvbnMgYXQgb25jZSwgYWxsb3dpbmcgZm9yIG5hdGl2ZSBvcHRpbWl6YXRpb25zIGFuZCBwcm92aWRlIHRoZVxuICAgKiBjb252ZW5pZW5jZSBvZiBhIHNpbmdsZSBjYWxsYmFjayBhZnRlciBhbGwgb3BlcmF0aW9ucyBhcmUgY29tcGxldGUuXG4gICAqXG4gICAqIFRoZXNlIGZ1bmN0aW9ucyByZXR1cm4gYXJyYXlzIG9mIGVycm9ycywgcG90ZW50aWFsbHkgb25lIGZvciBldmVyeSBrZXkuXG4gICAqIEZvciBrZXktc3BlY2lmaWMgZXJyb3JzLCB0aGUgRXJyb3Igb2JqZWN0IHdpbGwgaGF2ZSBhIGtleSBwcm9wZXJ0eSB0b1xuICAgKiBpbmRpY2F0ZSB3aGljaCBrZXkgY2F1c2VkIHRoZSBlcnJvci5cbiAgICovXG5cbiAgLyoqXG4gICAqIEZsdXNoZXMgYW55IHBlbmRpbmcgcmVxdWVzdHMgdXNpbmcgYSBzaW5nbGUgYmF0Y2ggY2FsbCB0byBnZXQgdGhlIGRhdGEuXG4gICAqXG4gICAqIFNlZSBodHRwOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL2FzeW5jc3RvcmFnZS5odG1sI2ZsdXNoZ2V0cmVxdWVzdHNcbiAgICogKi9cbiAgZmx1c2hHZXRSZXF1ZXN0czogZnVuY3Rpb24oKTogdm9pZCB7XG4gICAgY29uc3QgZ2V0UmVxdWVzdHMgPSB0aGlzLl9nZXRSZXF1ZXN0cztcbiAgICBjb25zdCBnZXRLZXlzID0gdGhpcy5fZ2V0S2V5cztcblxuICAgIHRoaXMuX2dldFJlcXVlc3RzID0gW107XG4gICAgdGhpcy5fZ2V0S2V5cyA9IFtdO1xuXG4gICAgUkNUQXN5bmNTdG9yYWdlLm11bHRpR2V0KGdldEtleXMsIGZ1bmN0aW9uKGVycm9ycywgcmVzdWx0KSB7XG4gICAgICAvLyBFdmVuIHRob3VnaCB0aGUgcnVudGltZSBjb21wbGV4aXR5IG9mIHRoaXMgaXMgdGhlb3JldGljYWxseSB3b3JzZSB2cyBpZiB3ZSB1c2VkIGEgbWFwLFxuICAgICAgLy8gaXQncyBtdWNoLCBtdWNoIGZhc3RlciBpbiBwcmFjdGljZSBmb3IgdGhlIGRhdGEgc2V0cyB3ZSBkZWFsIHdpdGggKHdlIGF2b2lkXG4gICAgICAvLyBhbGxvY2F0aW5nIHJlc3VsdCBwYWlyIGFycmF5cykuIFRoaXMgd2FzIGhlYXZpbHkgYmVuY2htYXJrZWQuXG4gICAgICAvL1xuICAgICAgLy8gSXMgdGhlcmUgYSB3YXkgdG8gYXZvaWQgdXNpbmcgdGhlIG1hcCBidXQgZml4IHRoZSBidWcgaW4gdGhpcyBicmVha2luZyB0ZXN0P1xuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0LW5hdGl2ZS9jb21taXQvOGRkOGFkNzY1NzlkN2ZlZWYzNGMwMTRkMzg3YmYwMjA2NTY5MjI2NFxuICAgICAgY29uc3QgbWFwID0ge307XG4gICAgICByZXN1bHQgJiZcbiAgICAgICAgcmVzdWx0LmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICAgIG1hcFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIGNvbnN0IHJlcUxlbmd0aCA9IGdldFJlcXVlc3RzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVxTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IGdldFJlcXVlc3RzW2ldO1xuICAgICAgICBjb25zdCByZXF1ZXN0S2V5cyA9IHJlcXVlc3Qua2V5cztcbiAgICAgICAgY29uc3QgcmVxdWVzdFJlc3VsdCA9IHJlcXVlc3RLZXlzLm1hcChrZXkgPT4gW2tleSwgbWFwW2tleV1dKTtcbiAgICAgICAgcmVxdWVzdC5jYWxsYmFjayAmJiByZXF1ZXN0LmNhbGxiYWNrKG51bGwsIHJlcXVlc3RSZXN1bHQpO1xuICAgICAgICByZXF1ZXN0LnJlc29sdmUgJiYgcmVxdWVzdC5yZXNvbHZlKHJlcXVlc3RSZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGlzIGFsbG93cyB5b3UgdG8gYmF0Y2ggdGhlIGZldGNoaW5nIG9mIGl0ZW1zIGdpdmVuIGFuIGFycmF5IG9mIGBrZXlgXG4gICAqIGlucHV0cy4gWW91ciBjYWxsYmFjayB3aWxsIGJlIGludm9rZWQgd2l0aCBhbiBhcnJheSBvZiBjb3JyZXNwb25kaW5nXG4gICAqIGtleS12YWx1ZSBwYWlycyBmb3VuZC5cbiAgICpcbiAgICogU2VlIGh0dHA6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvYXN5bmNzdG9yYWdlLmh0bWwjbXVsdGlnZXRcbiAgICovXG4gIG11bHRpR2V0OiBmdW5jdGlvbihcbiAgICBrZXlzOiBBcnJheTxzdHJpbmc+LFxuICAgIGNhbGxiYWNrPzogP011bHRpR2V0Q2FsbGJhY2tGdW5jdGlvbixcbiAgKTogUHJvbWlzZTw/JFJlYWRPbmx5QXJyYXk8UmVhZE9ubHlBcnJheVN0cmluZz4+IHtcbiAgICBpZiAoIXRoaXMuX2ltbWVkaWF0ZSkge1xuICAgICAgdGhpcy5faW1tZWRpYXRlID0gc2V0SW1tZWRpYXRlKCgpID0+IHtcbiAgICAgICAgdGhpcy5faW1tZWRpYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5mbHVzaEdldFJlcXVlc3RzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBnZXRSZXF1ZXN0OiBNdWx0aVJlcXVlc3QgPSB7XG4gICAgICBrZXlzOiBrZXlzLFxuICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgICAgLy8gZG8gd2UgbmVlZCB0aGlzP1xuICAgICAga2V5SW5kZXg6IHRoaXMuX2dldEtleXMubGVuZ3RoLFxuICAgICAgcmVzb2x2ZTogbnVsbCxcbiAgICAgIHJlamVjdDogbnVsbCxcbiAgICB9O1xuXG4gICAgY29uc3QgcHJvbWlzZVJlc3VsdCA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGdldFJlcXVlc3QucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICBnZXRSZXF1ZXN0LnJlamVjdCA9IHJlamVjdDtcbiAgICB9KTtcblxuICAgIHRoaXMuX2dldFJlcXVlc3RzLnB1c2goZ2V0UmVxdWVzdCk7XG4gICAgLy8gYXZvaWQgZmV0Y2hpbmcgZHVwbGljYXRlc1xuICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgaWYgKHRoaXMuX2dldEtleXMuaW5kZXhPZihrZXkpID09PSAtMSkge1xuICAgICAgICB0aGlzLl9nZXRLZXlzLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBwcm9taXNlUmVzdWx0O1xuICB9LFxuXG4gIC8qKlxuICAgKiBVc2UgdGhpcyBhcyBhIGJhdGNoIG9wZXJhdGlvbiBmb3Igc3RvcmluZyBtdWx0aXBsZSBrZXktdmFsdWUgcGFpcnMuIFdoZW5cbiAgICogdGhlIG9wZXJhdGlvbiBjb21wbGV0ZXMgeW91J2xsIGdldCBhIHNpbmdsZSBjYWxsYmFjayB3aXRoIGFueSBlcnJvcnMuXG4gICAqXG4gICAqIFNlZSBodHRwOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL2FzeW5jc3RvcmFnZS5odG1sI211bHRpc2V0XG4gICAqL1xuICBtdWx0aVNldDogZnVuY3Rpb24oXG4gICAga2V5VmFsdWVQYWlyczogQXJyYXk8QXJyYXk8c3RyaW5nPj4sXG4gICAgY2FsbGJhY2s/OiA/KGVycm9yczogPyRSZWFkT25seUFycmF5PD9FcnJvcj4pID0+IHZvaWQsXG4gICk6IFByb21pc2U8bnVsbD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBrZXlWYWx1ZVBhaXJzLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBjaGVja1ZhbGlkSW5wdXQoa2V5LCB2YWx1ZSk7XG4gICAgICB9KTtcblxuICAgICAgUkNUQXN5bmNTdG9yYWdlLm11bHRpU2V0KGtleVZhbHVlUGFpcnMsIGZ1bmN0aW9uKGVycm9ycykge1xuICAgICAgICBjb25zdCBlcnJvciA9IGNvbnZlcnRFcnJvcnMoZXJyb3JzKTtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZXJyb3IpO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsIHRoaXMgdG8gYmF0Y2ggdGhlIGRlbGV0aW9uIG9mIGFsbCBrZXlzIGluIHRoZSBga2V5c2AgYXJyYXkuXG4gICAqXG4gICAqIFNlZSBodHRwOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL2FzeW5jc3RvcmFnZS5odG1sI211bHRpcmVtb3ZlXG4gICAqL1xuICBtdWx0aVJlbW92ZTogZnVuY3Rpb24oXG4gICAga2V5czogQXJyYXk8c3RyaW5nPixcbiAgICBjYWxsYmFjaz86ID8oZXJyb3JzOiA/JFJlYWRPbmx5QXJyYXk8P0Vycm9yPikgPT4gdm9pZCxcbiAgKTogUHJvbWlzZTxudWxsPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGtleXMuZm9yRWFjaChrZXkgPT4gY2hlY2tWYWxpZElucHV0KGtleSkpO1xuXG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlSZW1vdmUoa2V5cywgZnVuY3Rpb24oZXJyb3JzKSB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gY29udmVydEVycm9ycyhlcnJvcnMpO1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlcnJvcik7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEJhdGNoIG9wZXJhdGlvbiB0byBtZXJnZSBpbiBleGlzdGluZyBhbmQgbmV3IHZhbHVlcyBmb3IgYSBnaXZlbiBzZXQgb2ZcbiAgICoga2V5cy4gVGhpcyBhc3N1bWVzIHRoYXQgdGhlIHZhbHVlcyBhcmUgc3RyaW5naWZpZWQgSlNPTi5cbiAgICpcbiAgICogKipOT1RFKio6IFRoaXMgaXMgbm90IHN1cHBvcnRlZCBieSBhbGwgbmF0aXZlIGltcGxlbWVudGF0aW9ucy5cbiAgICpcbiAgICogU2VlIGh0dHA6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvYXN5bmNzdG9yYWdlLmh0bWwjbXVsdGltZXJnZVxuICAgKi9cbiAgbXVsdGlNZXJnZTogZnVuY3Rpb24oXG4gICAga2V5VmFsdWVQYWlyczogQXJyYXk8QXJyYXk8c3RyaW5nPj4sXG4gICAgY2FsbGJhY2s/OiA/KGVycm9yczogPyRSZWFkT25seUFycmF5PD9FcnJvcj4pID0+IHZvaWQsXG4gICk6IFByb21pc2U8bnVsbD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlNZXJnZShrZXlWYWx1ZVBhaXJzLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBjb252ZXJ0RXJyb3JzKGVycm9ycyk7XG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycm9yKTtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKG51bGwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcbn07XG5cbi8vIE5vdCBhbGwgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBzdXBwb3J0IG1lcmdlLlxuaWYgKCFSQ1RBc3luY1N0b3JhZ2UubXVsdGlNZXJnZSkge1xuICBkZWxldGUgQXN5bmNTdG9yYWdlLm1lcmdlSXRlbTtcbiAgZGVsZXRlIEFzeW5jU3RvcmFnZS5tdWx0aU1lcmdlO1xufVxuXG5mdW5jdGlvbiBjb252ZXJ0RXJyb3JzKGVycnMpOiA/JFJlYWRPbmx5QXJyYXk8P0Vycm9yPiB7XG4gIGlmICghZXJycykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiAoQXJyYXkuaXNBcnJheShlcnJzKSA/IGVycnMgOiBbZXJyc10pLm1hcChlID0+IGNvbnZlcnRFcnJvcihlKSk7XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnRFcnJvcihlcnJvcik6ID9FcnJvciB7XG4gIGlmICghZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBvdXQgPSBuZXcgRXJyb3IoZXJyb3IubWVzc2FnZSk7XG4gIC8vICRGbG93Rml4TWU6IGFkZGluZyBjdXN0b20gcHJvcGVydGllcyB0byBlcnJvci5cbiAgb3V0LmtleSA9IGVycm9yLmtleTtcbiAgcmV0dXJuIG91dDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQXN5bmNTdG9yYWdlO1xuIl19